{% extends "base.html" %}
{% load static %}

{% block 'head' %}
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adicionar Despesa do Processo</title>
<link rel="stylesheet" href="{% static "finances/css/register-finances.css" %}">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock 'head' %}

{% block 'body' %}
{% include "partials/navbar.html" %}
  <header class="process-header">
    <h1>Financeiro</h1>
    <p>Permite visualizar e adicionar despesas.</p>
  </header>

  <div class="form-button-container">
    <button id="toggle-form" class="form-button">Adicionar Nova Despesa</button>
    <button id="close-form" class="form-button">Fechar</button>
  </div>

  <!-- Overlay -->
  <div id="overlay" class="overlay"></div>

  <form method="POST" id="expense-form" class="form-container">{% csrf_token %}
    <select name="process_title" class="form-input" required>
        <option value="" disabled selected>Processo</option>
        {% for process in processes %}
            <option value="{{ process.titulo }}">{{ process.titulo }}</option>
        {% endfor %}
    </select>

    <textarea placeholder="Descrição do Gasto" id="description" name="description" rows="3" class="form-input" required></textarea><br><br>

    <input placeholder="Valor" type="number" id="amount" name="amount" step="0.01" class="form-input" required><br><br>

    <input placeholder="Data da Despesa" type="date" id="expense_date" name="expense_date" class="form-input" required><br><br>

    <select id="expense_type" name="expense_type" class="form-input" required>
      <option value="" disabled selected>Selecione o Tipo Despesa:</option>
      <option value="judicial_fee">Custas processuais</option>
      <option value="attorney_fee">Honorários advocatícios</option>
      <option value="operational">Despesas operacionais</option>
      <option value="third_party">Honorários de terceiros</option>
      <option value="documentation">Taxas de documentação</option>
      <option value="penalty">Multas ou penalidades</option>
      <option value="notification">Notificações e intimações</option>
    </select><br><br>

    <button class="submit-button" type="submit">Salvar</button>
  </form>

  <main class="container">
    <section class="expense-info">
      <h2>Despesas</h2>
        <table class="expense-table">
          <thead>
            <tr>
              <th>Processo Associado</th>
              <th>Descrição</th>
              <th>Valor</th>
              <th>Data da Despesa</th>
              <th>Tipo de Despesa</th>
            </tr>
          </thead>
          <tbody>
            {% for expense in expenses %}
            <tr>
              <td>{{ expense.process.titulo }}</td>
              <td>{{ expense.description }}</td>
              <td>R$ {{ expense.amount }}</td>
              <td>{{ expense.expense_date }}</td>
              <td>{{ expense.expense_type }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
    </section>
  </main>



  <script src="{% static "finances/js/forms-visibility.js" %}"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
{% endblock 'body' %}